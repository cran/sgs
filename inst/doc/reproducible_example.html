<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Fabio Feser" />

<meta name="date" content="2025-09-30" />

<title>sgs reproducible example</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">sgs reproducible example</h1>
<h4 class="author">Fabio Feser</h4>
<h4 class="date">2025-09-30</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>sgs</code> R package fits sparse-group SLOPE (SGS) and
group SLOPE (gSLOPE) models. The package has implementations for linear
and logisitic regression, both of which are demonstrated here. The
package also uses strong screening rules to speed up computational time,
described in detail in <a href="https://arxiv.org/abs/2405.15357">F.
Feser, M. Evangelou (2024) “Strong Screening Rules for Group-based SLOPE
Models”</a>. Screening rules are applied by default here. However, the
impact of screening is demonstrated in the Screening section at the
end.</p>
</div>
<div id="sparse-group-slope" class="section level1">
<h1>Sparse-group SLOPE</h1>
<p>Sparse-group SLOPE (SGS) is a penalised regression approach that
performs bi-level selection with FDR control under orthogonal designs.
SGS is described in detail in <a href="https://arxiv.org/abs/2305.09467">F. Feser, M. Evangelou (2023)
“Sparse-group SLOPE: adaptive bi-level selection with
FDR-control”</a>.</p>
<div id="linear-regression" class="section level2">
<h2>Linear regression</h2>
<div id="data" class="section level3">
<h3>Data</h3>
<p>For this example, a <span class="math inline">\(400 \times
500\)</span> input matrix is used with a simple grouping structure,
sampled from a multivariate Gaussian distribution with no
correlation.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(sgs)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>groups <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">each =</span> <span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">each =</span> <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">41</span><span class="sc">:</span><span class="dv">60</span>,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="at">each =</span> <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">61</span><span class="sc">:</span><span class="dv">80</span>, <span class="at">each =</span> <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">81</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">each =</span> <span class="dv">7</span>))</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">gen_toy_data</span>(<span class="at">p =</span> <span class="dv">500</span>, <span class="at">n =</span> <span class="dv">400</span>, <span class="at">groups =</span> groups, <span class="at">seed_id =</span> <span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="fitting-an-sgs-model" class="section level3">
<h3>Fitting an SGS model</h3>
<p>We now fit an SGS model to the data using linear regression. The SGS
model has many different hyperparameters which can be tuned/selected. Of
particular importance is the <span class="math inline">\(\lambda\)</span> parameter, which defines the
level of sparsity in the model. First, we select this manually and then
next use cross-validation to tune it. The other parameters we leave as
their default values, although they can easily be changed.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">fit_sgs</span>(<span class="at">X =</span> data<span class="sc">$</span>X, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">groups =</span> groups, <span class="at">type =</span> <span class="st">&quot;linear&quot;</span>,</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>, <span class="at">vFDR =</span> <span class="fl">0.1</span>, <span class="at">gFDR =</span> <span class="fl">0.1</span>, <span class="at">standardise =</span> <span class="st">&quot;l2&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">screen =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Note: we have fit an intercept and applied <span class="math inline">\(\ell_2\)</span> standardisation. This is the
recommended usage when applying SGS with linear regression. The lambda
values can also be calculated automatically, starting at the null model
and continuing as specified by and :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>model_path <span class="ot">=</span> <span class="fu">fit_sgs</span>(<span class="at">X =</span> data<span class="sc">$</span>X, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">groups =</span> groups,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;linear&quot;</span>, <span class="at">lambda =</span> <span class="st">&quot;path&quot;</span>, <span class="at">path_length =</span> <span class="dv">5</span>, <span class="at">min_frac =</span> <span class="fl">0.1</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.95</span>, <span class="at">vFDR =</span> <span class="fl">0.1</span>, <span class="at">gFDR =</span> <span class="fl">0.1</span>, <span class="at">standardise =</span> <span class="st">&quot;l2&quot;</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">screen =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="output-of-model" class="section level3">
<h3>Output of model</h3>
<p>The package provides several useful outputs after fitting a model.
The vector shows the fitted values (note the intercept). We can also
recover the indices of the non-zero variables and groups, which are
indexed from the first variable, not the intercept.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>model<span class="sc">$</span>beta[model<span class="sc">$</span>selected_var <span class="sc">+</span> <span class="dv">1</span>]  <span class="co"># the +1 is to account for the intercept</span></span></code></pre></div>
<pre><code>##  [1] -1.70359057 -1.51619035  3.19485206 -0.03116136  1.66521214  5.06316228
##  [7] -1.48582935  1.30402890 -0.94992292  5.02074891 -0.67249170 -1.47281080
## [13] -2.26324184  1.64877215 -1.69735702 -0.74801830</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>model<span class="sc">$</span>group_effects[model<span class="sc">$</span>selected_grp]</span></code></pre></div>
<pre><code>## [1] 3.92531956 0.03116136 5.32996658 1.48582935 1.30402890 5.10982125 1.61907897
## [8] 2.26324184 2.48173363</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>model<span class="sc">$</span>selected_var</span></code></pre></div>
<pre><code>##  [1]  97  99 100 109 133 136 170 217 231 234 260 263 334 391 393 394</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>model<span class="sc">$</span>selected_grp</span></code></pre></div>
<pre><code>## [1] 30 33 39 46 56 59 64 76 85</code></pre>
<p>Defining a function that lets us calculate various metrics (including
the FDR and sensitivity):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>fdr_sensitivity <span class="ot">=</span> <span class="cf">function</span>(fitted_ids, true_ids, num_coef) {</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>    <span class="co"># calculates FDR, FPR, and sensitivity</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    num_true <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">intersect</span>(fitted_ids, true_ids))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    num_false <span class="ot">=</span> <span class="fu">length</span>(fitted_ids) <span class="sc">-</span> num_true</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    num_missed <span class="ot">=</span> <span class="fu">length</span>(true_ids) <span class="sc">-</span> num_true</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>    num_true_negatives <span class="ot">=</span> num_coef <span class="sc">-</span> <span class="fu">length</span>(true_ids)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    out <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    out<span class="sc">$</span>fdr <span class="ot">=</span> num_false<span class="sc">/</span>(num_true <span class="sc">+</span> num_false)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.nan</span>(out<span class="sc">$</span>fdr)) {</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>        out<span class="sc">$</span>fdr <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>    }</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>    out<span class="sc">$</span>sensitivity <span class="ot">=</span> num_true<span class="sc">/</span><span class="fu">length</span>(true_ids)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(true_ids) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>        out<span class="sc">$</span>sensitivity <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>    }</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>    out<span class="sc">$</span>fpr <span class="ot">=</span> num_false<span class="sc">/</span>num_true_negatives</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>    out<span class="sc">$</span>f1 <span class="ot">=</span> (<span class="dv">2</span> <span class="sc">*</span> num_true)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> num_true <span class="sc">+</span> num_false <span class="sc">+</span> num_missed)</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.nan</span>(out<span class="sc">$</span>f1)) {</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>        out<span class="sc">$</span>f1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>    }</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>}</span></code></pre></div>
<p>Calculating relevant metrics give</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">fdr_sensitivity</span>(<span class="at">fitted_ids =</span> model<span class="sc">$</span>selected_var, <span class="at">true_ids =</span> data<span class="sc">$</span>true_var_id,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>    <span class="at">num_coef =</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>## $fdr
## [1] 0
## 
## $sensitivity
## [1] 0.5714286
## 
## $fpr
## [1] 0
## 
## $f1
## [1] 0.7272727</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">fdr_sensitivity</span>(<span class="at">fitted_ids =</span> model<span class="sc">$</span>selected_grp, <span class="at">true_ids =</span> data<span class="sc">$</span>true_grp_id,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>    <span class="at">num_coef =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## $fdr
## [1] 0
## 
## $sensitivity
## [1] 0.9
## 
## $fpr
## [1] 0
## 
## $f1
## [1] 0.9473684</code></pre>
<p>The model is currently too sparse, as our choice of <span class="math inline">\(\lambda\)</span> is too high. We can instead use
cross-validation.</p>
</div>
<div id="cross-validation" class="section level3">
<h3>Cross validation</h3>
<p>Cross-validation is used to fit SGS models along a <span class="math inline">\(\lambda\)</span> path of length <span class="math inline">\(20\)</span>. The first value, <span class="math inline">\(\lambda_\text{max}\)</span>, is chosen to give the
null model and the path is terminated at <span class="math inline">\(\lambda_\text{min} = \delta
\lambda_\text{max}\)</span>, where <span class="math inline">\(\delta\)</span> is some value between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span> (given by in the function). The 1se
rule (as in the package) is used to choose the optimal model.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>cv_model <span class="ot">=</span> <span class="fu">fit_sgs_cv</span>(<span class="at">X =</span> data<span class="sc">$</span>X, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">groups =</span> groups,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;linear&quot;</span>, <span class="at">path_length =</span> <span class="dv">20</span>, <span class="at">nfolds =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>    <span class="at">vFDR =</span> <span class="fl">0.1</span>, <span class="at">gFDR =</span> <span class="fl">0.1</span>, <span class="at">min_frac =</span> <span class="fl">0.05</span>, <span class="at">standardise =</span> <span class="st">&quot;l2&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">screen =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Fold 1/10 done. Error: 3587.46352973189&quot;
## [1] &quot;Fold 2/10 done. Error: 2396.37451004873&quot;
## [1] &quot;Fold 3/10 done. Error: 3244.98656447063&quot;
## [1] &quot;Fold 4/10 done. Error: 3264.25029382017&quot;
## [1] &quot;Fold 5/10 done. Error: 3187.48670434299&quot;
## [1] &quot;Fold 6/10 done. Error: 2773.26771142741&quot;
## [1] &quot;Fold 7/10 done. Error: 3231.2422676838&quot;
## [1] &quot;Fold 8/10 done. Error: 4476.62268630096&quot;
## [1] &quot;Fold 9/10 done. Error: 3449.11503742538&quot;
## [1] &quot;Fold 10/10 done. Error: 3710.53353879839&quot;</code></pre>
<p>The fitting verbose contains useful information, showing the error
for each fold. Aside from the fitting verbose, we can see a more
succinct summary by using the function</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">print</span>(cv_model)</span></code></pre></div>
<pre><code>## 
##  regression type:  
## 
##           lambda     error num.nonzero
##  [1,] 1.91363372 9524.4888           0
##  [2,] 1.63449483 9277.7401           1
##  [3,] 1.39607352 8542.7212           2
##  [4,] 1.19243036 7687.9926           3
##  [5,] 1.01849233 6915.9635           4
##  [6,] 0.86992638 5746.3576          14
##  [7,] 0.74303152 4427.2188          15
##  [8,] 0.63464662 3405.7949          15
##  [9,] 0.54207167 2654.6456          15
## [10,] 0.46300049 2084.2636          16
## [11,] 0.39546330 1618.8663          22
## [12,] 0.33777766 1226.0384          22
## [13,] 0.28850654  926.7801          22
## [14,] 0.24642252  707.1735          22
## [15,] 0.21047724  544.7951          24
## [16,] 0.17977524  420.1590          24
## [17,] 0.15355169  324.7006          26
## [18,] 0.13115334  251.3890          26
## [19,] 0.11202220  197.5157          27
## [20,] 0.09568169  158.0814          27</code></pre>
<p>The best model is found to be the one at the end of the path:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>cv_model<span class="sc">$</span>best_lambda_id</span></code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>Checking the metrics again, we see how CV has generated a model with
the correct amount of sparsity that gives FDR levels below the specified
values.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">fdr_sensitivity</span>(<span class="at">fitted_ids =</span> cv_model<span class="sc">$</span>fit<span class="sc">$</span>selected_var, <span class="at">true_ids =</span> data<span class="sc">$</span>true_var_id,</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>    <span class="at">num_coef =</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>## $fdr
## [1] 0.03703704
## 
## $sensitivity
## [1] 0.9285714
## 
## $fpr
## [1] 0.002118644
## 
## $f1
## [1] 0.9454545</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">fdr_sensitivity</span>(<span class="at">fitted_ids =</span> cv_model<span class="sc">$</span>fit<span class="sc">$</span>selected_grp, <span class="at">true_ids =</span> data<span class="sc">$</span>true_grp_id,</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>    <span class="at">num_coef =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## $fdr
## [1] 0.09090909
## 
## $sensitivity
## [1] 1
## 
## $fpr
## [1] 0.01111111
## 
## $f1
## [1] 0.952381</code></pre>
</div>
<div id="plot" class="section level3">
<h3>Plot</h3>
<p>We can visualise the solution using the plot function:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">plot</span>(cv_model, <span class="at">how_many =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="prediction" class="section level3">
<h3>Prediction</h3>
<p>The package has an implemented predict function to allow for easy
prediction. The predict function can be used on regular and CV model
fits.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">predict</span>(model, data<span class="sc">$</span>X)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1]  7.5669801 -2.5809301  7.9012955  0.7832665 -4.9043138</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">predict</span>(cv_model, data<span class="sc">$</span>X))</span></code></pre></div>
<pre><code>## [1] 400  20</code></pre>
</div>
</div>
<div id="logistic-regression" class="section level2">
<h2>Logistic regression</h2>
<p>As mentioned, the package can also be used to fit SGS to a binary
response. First, we generate some binary data. We can use the same input
matrix, <span class="math inline">\(X\)</span>, and true <span class="math inline">\(\beta\)</span> as before. We split the data into
train and test to test the models classification performance.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>sigmoid <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>}</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">sigmoid</span>(data<span class="sc">$</span>X <span class="sc">%*%</span> data<span class="sc">$</span>true_beta <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">400</span>)) <span class="sc">&gt;</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>    <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>train_y <span class="ot">=</span> y[<span class="dv">1</span><span class="sc">:</span><span class="dv">350</span>]</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>test_y <span class="ot">=</span> y[<span class="dv">351</span><span class="sc">:</span><span class="dv">400</span>]</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>train_X <span class="ot">=</span> data<span class="sc">$</span>X[<span class="dv">1</span><span class="sc">:</span><span class="dv">350</span>, ]</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>test_X <span class="ot">=</span> data<span class="sc">$</span>X[<span class="dv">351</span><span class="sc">:</span><span class="dv">400</span>, ]</span></code></pre></div>
<div id="fitting-and-prediction" class="section level3">
<h3>Fitting and prediction</h3>
<p>We can again apply CV.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>cv_model <span class="ot">=</span> <span class="fu">fit_sgs_cv</span>(<span class="at">X =</span> train_X, <span class="at">y =</span> train_y, <span class="at">groups =</span> groups,</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;logistic&quot;</span>, <span class="at">path_length =</span> <span class="dv">20</span>, <span class="at">nfolds =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>,</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>    <span class="at">vFDR =</span> <span class="fl">0.1</span>, <span class="at">gFDR =</span> <span class="fl">0.1</span>, <span class="at">min_frac =</span> <span class="fl">0.05</span>, <span class="at">standardise =</span> <span class="st">&quot;l2&quot;</span>,</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="cn">FALSE</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>, <span class="at">screen =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Fold 1/10 done. Error: 0.244285714285714&quot;
## [1] &quot;Fold 2/10 done. Error: 0.187142857142857&quot;
## [1] &quot;Fold 3/10 done. Error: 0.252857142857143&quot;
## [1] &quot;Fold 4/10 done. Error: 0.194285714285714&quot;
## [1] &quot;Fold 5/10 done. Error: 0.164285714285714&quot;
## [1] &quot;Fold 6/10 done. Error: 0.205714285714286&quot;
## [1] &quot;Fold 7/10 done. Error: 0.194285714285714&quot;
## [1] &quot;Fold 8/10 done. Error: 0.112857142857143&quot;
## [1] &quot;Fold 9/10 done. Error: 0.21&quot;
## [1] &quot;Fold 10/10 done. Error: 0.218571428571429&quot;</code></pre>
<p>and again, use the predict function</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>predictions <span class="ot">=</span> <span class="fu">predict</span>(cv_model, test_X)</span></code></pre></div>
<p>For logistic regression, the function returns both the predicted
class probabilities (<code>response</code>) and the predicted class
(<code>class</code>). We can use this to check the prediction accuracy,
given as <span class="math inline">\(82\%\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>predictions<span class="sc">$</span>response[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, cv_model<span class="sc">$</span>best_lambda_id]</span></code></pre></div>
<pre><code>## [1] 0.47968400 0.50407223 0.09066721 0.11938235 0.35718582</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>predictions<span class="sc">$</span>class[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, cv_model<span class="sc">$</span>best_lambda_id]</span></code></pre></div>
<pre><code>## [1] 0 1 0 0 0</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">sum</span>(predictions<span class="sc">$</span>class[, cv_model<span class="sc">$</span>best_lambda_id] <span class="sc">==</span> test_y)<span class="sc">/</span><span class="fu">length</span>(test_y)</span></code></pre></div>
<pre><code>## [1] 0.86</code></pre>
</div>
</div>
</div>
<div id="group-slope" class="section level1">
<h1>Group SLOPE</h1>
<p>Group SLOPE (gSLOPE) applies adaptive group penalisation to control
the group FDR under orthogonal designs. gSLOPE is described in detail in
<a href="https://doi.org/10.1080/01621459.2017.1411269">Brzyski, D.,
Gossmann, A., Su, W., Bogdan, M. (2019). <em>Group SLOPE – Adaptive
Selection of Groups of Predictors</em></a>. gSLOPE is implemented in the
<code>sgs</code> package with the same features as SGS. Here, we briefly
demonstrate how to fit a gSLOPE model.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>groups <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">each =</span> <span class="dv">3</span>), <span class="fu">rep</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">each =</span> <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">41</span><span class="sc">:</span><span class="dv">60</span>,</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>    <span class="at">each =</span> <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">61</span><span class="sc">:</span><span class="dv">80</span>, <span class="at">each =</span> <span class="dv">6</span>), <span class="fu">rep</span>(<span class="dv">81</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">each =</span> <span class="dv">7</span>))</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">gen_toy_data</span>(<span class="at">p =</span> <span class="dv">500</span>, <span class="at">n =</span> <span class="dv">400</span>, <span class="at">groups =</span> groups, <span class="at">seed_id =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">fit_gslope</span>(<span class="at">X =</span> data<span class="sc">$</span>X, <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">groups =</span> groups, <span class="at">type =</span> <span class="st">&quot;linear&quot;</span>,</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fl">0.5</span>, <span class="at">gFDR =</span> <span class="fl">0.1</span>, <span class="at">standardise =</span> <span class="st">&quot;l2&quot;</span>, <span class="at">intercept =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">screen =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="screening" class="section level1">
<h1>Screening</h1>
<p>Screening rules allow the input dimensionality to be reduced before
fitting. The strong screening rules for gSLOPE and SGS are described in
detail in <a href="https://arxiv.org/abs/2405.15357">Feser, F.,
Evangelou, M. (2024). <em>Strong Screening Rules for Group-based SLOPE
Models</em></a>. Here, we demonstrate the effectiveness of screening
rules by looking at the speed improvement they provide. For SGS:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>screen_time <span class="ot">=</span> <span class="fu">system.time</span>(model_screen <span class="ot">&lt;-</span> <span class="fu">fit_sgs</span>(<span class="at">X =</span> data<span class="sc">$</span>X,</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>    <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">groups =</span> groups, <span class="at">type =</span> <span class="st">&quot;linear&quot;</span>, <span class="at">path_length =</span> <span class="dv">100</span>,</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.95</span>, <span class="at">vFDR =</span> <span class="fl">0.1</span>, <span class="at">gFDR =</span> <span class="fl">0.1</span>, <span class="at">standardise =</span> <span class="st">&quot;l2&quot;</span>,</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">screen =</span> <span class="cn">TRUE</span>))</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>no_screen_time <span class="ot">=</span> <span class="fu">system.time</span>(model_no_screen <span class="ot">&lt;-</span> <span class="fu">fit_sgs</span>(<span class="at">X =</span> data<span class="sc">$</span>X,</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>    <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">groups =</span> groups, <span class="at">type =</span> <span class="st">&quot;linear&quot;</span>, <span class="at">path_length =</span> <span class="dv">100</span>,</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.95</span>, <span class="at">vFDR =</span> <span class="fl">0.1</span>, <span class="at">gFDR =</span> <span class="fl">0.1</span>, <span class="at">standardise =</span> <span class="st">&quot;l2&quot;</span>,</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>, <span class="at">screen =</span> <span class="cn">FALSE</span>))</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>screen_time</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    5.64    0.14    6.06</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>no_screen_time</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    6.75    0.22    7.68</code></pre>
<p>and for gSLOPE:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>screen_time <span class="ot">=</span> <span class="fu">system.time</span>(model_screen <span class="ot">&lt;-</span> <span class="fu">fit_gslope</span>(<span class="at">X =</span> data<span class="sc">$</span>X,</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>    <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">groups =</span> groups, <span class="at">type =</span> <span class="st">&quot;linear&quot;</span>, <span class="at">path_length =</span> <span class="dv">100</span>,</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>    <span class="at">gFDR =</span> <span class="fl">0.1</span>, <span class="at">standardise =</span> <span class="st">&quot;l2&quot;</span>, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>    <span class="at">screen =</span> <span class="cn">TRUE</span>))</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>no_screen_time <span class="ot">=</span> <span class="fu">system.time</span>(model_no_screen <span class="ot">&lt;-</span> <span class="fu">fit_gslope</span>(<span class="at">X =</span> data<span class="sc">$</span>X,</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>    <span class="at">y =</span> data<span class="sc">$</span>y, <span class="at">groups =</span> groups, <span class="at">type =</span> <span class="st">&quot;linear&quot;</span>, <span class="at">path_length =</span> <span class="dv">100</span>,</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>    <span class="at">gFDR =</span> <span class="fl">0.1</span>, <span class="at">standardise =</span> <span class="st">&quot;l2&quot;</span>, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>    <span class="at">screen =</span> <span class="cn">FALSE</span>))</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>screen_time</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    2.78    0.13    3.30</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>no_screen_time</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    6.26    0.08    7.00</code></pre>
<div id="reference" class="section level2">
<h2>Reference</h2>
<ul>
<li><a href="https://doi.org/10.1080/01621459.2017.1411269">Brzyski, D.,
Gossmann, A., Su, W., Bogdan, M. (2019). <em>Group SLOPE – Adaptive
Selection of Groups of Predictors</em></a>.</li>
<li><a href="https://arxiv.org/abs/2305.09467">Feser, F., Evangelou, M.
(2023). <em>Sparse-group SLOPE: adaptive bi-level selection with
FDR-control</em></a>.</li>
<li><a href="https://arxiv.org/abs/2405.15357">Feser, F., Evangelou, M.
(2024). <em>Strong screening rules for group-based SLOPE
models</em></a>.</li>
</ul>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
